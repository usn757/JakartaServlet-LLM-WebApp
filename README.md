## 프로젝트 진행 과정 문서 (초안, 더 수정해야함)

### 1. 프로젝트 개요

본 문서는 IntelliJ IDEA를 사용하여 개발된 REST API 연동 웹 애플리케이션 개발 과정을 정리한 것입니다.  웹 애플리케이션은 사용자 질문을 Large Language Model (LLM) API에 전달하고, API 응답 결과를 화면에 표시하는 기능을 제공합니다.  초기에는 레시피 관련 질의응답 기능을 목표로 개발되었으나,  LLM 연동 범용 웹 애플리케이션으로 확장 가능성을 염두에 두고 개발되었습니다.

### 2. 개발 환경

*   **IDE:** IntelliJ IDEA
*   **백엔드:** 자카르타 서블릿 API (Jakarta Servlet API)
*   **웹 서버:** 톰캣 (Tomcat)
*   **API:** REST API (JSON 기반)
*   **클라이언트:** HTML, JavaScript
*   **배포 환경:** Render (클라우드 웹 호스팅 플랫폼), 도커 (Docker)

### 3. 주요 기능

*   **질문 입력:** 사용자는 웹 페이지의 입력 필드에 질문을 텍스트로 입력할 수 있습니다.
*   **모델 선택:** 사용자는 드롭다운 메뉴에서 LLM 모델 (GROQ, TOGETHER) 을 선택할 수 있습니다.
*   **API 호출:** "묻기" 버튼 클릭 시, JavaScript 코드가 입력된 질문과 선택된 모델 정보를 REST API 엔드포인트 (`/api`) 로 전송합니다.
*   **API 응답 표시:** API 서버로부터 JSON 형식으로 응답을 받아, 응답 내용 (텍스트) 을 웹 페이지의 지정된 영역 (`<div id="response">`) 에 표시합니다.
*   **로딩 표시:** API 호출 중에는 사용자에게 로딩 중임을 시각적으로 알리는 "로딩 중..." 메시지가 표시됩니다.
*   **오류 처리:** API 호출 실패 또는 응답 데이터 오류 발생 시, 사용자에게 적절한 오류 메시지를 표시하고, 개발자 콘솔에 자세한 오류 정보를 기록합니다.
*   **모델 선택 유지:** 사용자가 마지막으로 선택한 모델을 LocalStorage 에 저장하여, 페이지 재방문 시에도 동일한 모델이 선택되도록 합니다.

### 4. 문제 해결 과정 및 주요 이슈

#### 4.1. 초기 문제: "API 호출 중 오류 발생" 메시지, 네트워크 탭 데이터 도착 확인

*   **증상:** 웹 페이지에서 "묻기" 버튼 클릭 시 "API 호출 중 오류가 발생했습니다." 라는 메시지가 표시되었지만, 개발자 도구 네트워크 탭에서는 API 서버로부터 데이터가 정상적으로 도착하는 것이 확인되었습니다.
*   **원인 분석:** API 호출 자체는 성공했으나, JavaScript 코드에서 API 응답 데이터를 처리하는 과정에서 오류가 발생했을 가능성을 의심하고 문제 해결을 시작했습니다.

#### 4.2. 문제 해결 단계별 점검

1.  **개발자 도구 네트워크 탭 재확인:** API 응답 데이터 도착 여부 및 HTTP 상태 코드 200 OK 확인. (API 통신 자체는 정상)
2.  **HTML `response` div 요소 내용 확인 (개발자 도구 - 요소 탭):** `<div id="response">` 요소가 API 응답 내용으로 업데이트되지 않는 것을 확인. (JavaScript 코드에서 응답 내용 처리 및 화면 업데이트에 문제 가능성)
3.  **JavaScript 코드 오류 확인 (개발자 도구 - 콘솔 탭):** JavaScript 코드 문법 오류 또는 런타임 오류는 발견되지 않음.
4.  **API 응답 데이터 (`data`) 및 `data.content` 값 확인 (`console.log` 활용):** API 응답 데이터 구조 및 `content` 속성 존재 여부, 값의 유효성 등을 확인하기 위해 `console.log` 를 코드에 추가하여 API 응답 데이터를 개발자 도구 콘솔에 출력.
5.  **CSS 스타일 및 HTML 구조 문제 점검:**  `#response` div 요소가 CSS 스타일 문제 또는 HTML 구조 문제로 인해 화면에 보이지 않거나 가려져 있을 가능성 점검.
6.  **`white-space: pre-wrap;` CSS 스타일 확인:**  줄바꿈 관련 CSS 스타일이 문제 원인일 가능성은 낮다고 판단.
7.  **HTML 구조 문제 재확인:** `#response` div 요소가 다른 HTML 요소에 가려졌을 가능성 재점검.

#### 4.3. 오류 원인 식별 및 해결

*   **오류 1: `ReferenceError: Cannot access 'json' before initialization`**:
    *   **원인:** `async/await` 비동기 코드에서 `try...catch` 블록의 범위 설정 오류. `await response.json()` 에서 예외 발생 시 `catch` 블록으로 바로 점프하면서 `json` 변수가 초기화되기 전에 사용 시도.
    *   **해결:** `alert(JSON.stringify(json))` 코드를 `try` 블록 안으로 이동시켜, JSON 파싱 성공 후 `json` 변수를 사용하도록 코드 수정.

*   **오류 2: `SyntaxError: Bad control character in string literal in JSON at position ...`**:
    *   **원인:** API 서버 (서블릿) 에서 생성하는 JSON 응답 데이터가 유효한 JSON 형식이 아님. JSON 문자열 값에 제어 문자 (줄바꿈 문자 등) 가 이스케이프 처리 없이 그대로 포함되어 JSON 파싱 오류 발생.
    *   **해결:** 서블릿 코드 (`callAPI` 메소드) 에서 JSON 직렬화 라이브러리 (Jackson ObjectMapper) 를 사용하여 JSON 응답을 생성하도록 수정.  직접 JSON 문자열 생성 방식에서 라이브러리 사용 방식으로 변경하여 JSON 문법 오류 및 제어 문자 이스케이프 처리 문제 해결.

#### 4.4. 최종 해결: JSON 직렬화 라이브러리 적용 (서블릿 코드 수정)

Gson 또는 Jackson ObjectMapper 와 같은 JSON 직렬화 라이브러리를 서블릿 코드에 적용하여 JSON 응답을 생성하도록 수정함으로써,  `SyntaxError: Bad control character in string literal in JSON` 오류를 근본적으로 해결하고,  API 응답 데이터가 웹 페이지에 정상적으로 표시되도록 개선함.

### 5. 배포 과정

*   **도커 파일 (Dockerfile) 작성:** Maven 빌드 스테이지와 Tomcat 배포 스테이지로 구성된 도커 파일을 작성하여 웹 애플리케이션 컨테이너 이미지 빌드 자동화.
*   **Render 플랫폼 배포:** Render 웹 호스팅 플랫폼을 이용하여 도커 이미지를 기반으로 웹 애플리케이션을 클라우드 환경에 배포.  Render 플랫폼의 자동 배포 기능을 활용하여 배포 과정 간소화.

### 6. 코드 개선 사항 (반영 완료)

*   **사용자 경험 (UX) 개선:**
    *   입력 필드 및 모델 선택 레이블 명확화 (`<label>` 태그 사용).
    *   로딩 상태 표시 (`<div id="loading">` 추가 및 JavaScript 코드에서 제어).
    *   더 친절한 오류 메시지 (오류 유형에 따라 다른 메시지 표시).
    *   기본적인 CSS 스타일 적용 (웹 페이지 디자인 개선).
*   **코드 개선:**
    *   주석 추가 (코드 가독성 향상).
    *   `async`/`await` 를 사용한 비동기 처리 (코드 가독성 및 유지보수성 향상).
*   **추가 기능:**
    *   입력 필드 초기화 버튼 (`<button type="reset">` 추가).
    *   모델 선택 기억하기 (LocalStorage 활용).

### 7. 향후 개선 방향

*   **웹 페이지 UI/UX 추가 개선:** 레시피 제목/내용 분리, 로딩 애니메이션 추가, 모델 선택 메뉴 스타일 개선, 반응형 디자인 적용 등.
*   **서블릿 코드 기능 확장 및 개선:** API 요청 파라미터 다양화, 에러 처리 강화, 로그 기록 기능 추가, API 응답 구조 개선 (구조화된 JSON 응답) 등.
*   **지속적인 배포 (CD) 환경 구축:** GitHub 와 Render 연동을 통한 자동 배포 시스템 구축.
*   **더 복잡한 웹 애플리케이션 배포:** 데이터베이스 연동, 캐시 서버 활용, 로드 밸런싱 등 확장 가능한 구조 연구.

### 8. 결론

본 프로젝트는 IntelliJ IDEA, 자카르타 서블릿 API, 톰캣, REST API, 그리고 클라이언트 기술 (HTML, JavaScript) 을 활용하여 LLM 연동 웹 애플리케이션을 성공적으로 개발하고 배포하는 과정을 보여주었습니다.  개발 과정에서 JSON 파싱 오류 및 비동기 코드 오류와 같은 기술적인 문제들을 해결하고, 사용자 경험 및 코드 품질을 개선하기 위한 노력을 기울였습니다.  향후 지속적인 기능 개선 및 확장을 통해 더욱 완성도 높은 웹 서비스로 발전시켜나갈 계획입니다.

---

**참고:**

*   본 문서는 프로젝트 진행 과정에 대한 **초안 문서**이며,  향후 내용이 추가 또는 수정될 수 있습니다.
*   코드 개선 사항 및 추가 기능 관련 상세 코드는  본 문서에서 생략되었으며,  실제 코드 저장소 (GitHub 레포지토리) 에서 확인할 수 있습니다. (레포지토리 URL: [레포지토리 URL])  * [레포지토리 URL] 부분에 실제 깃헙 레포지토리 URL 을 추가해주세요.
*   배포 과정 관련 Render 플랫폼 설정 및 도커 파일 관련 상세 설정은  본 문서에서 간략하게 요약되었으며,  추후 상세 문서 또는 튜토리얼 형태로 보충될 수 있습니다.

**다음 단계:**

*   **본 문서 내용 검토 및 수정:**  문서 내용의 정확성, 완성도, 가독성 등을 검토하고 필요한 부분을 수정 및 보완합니다.
*   **깃헙 레포지토리 `README.md` 파일 작성:** 깃헙 레포지토리에 본 문서 내용을 기반으로 `README.md` 파일을 작성하여 프로젝트 개요, 기능, 사용 방법, 기술 스택, 개발 과정 등을 상세히 설명합니다.  프로젝트를 다른 개발자들에게 소개하고 공유하기 위한 중요한 자료가 됩니다.
*   **지속적인 프로젝트 개선 및 기능 확장:**  본 문서 7항 "향후 개선 방향" 에 제시된 내용들을 참고하여 웹 애플리케이션 기능 개선 및 확장을 지속적으로 추진합니다.
